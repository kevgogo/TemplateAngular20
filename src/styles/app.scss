/* =============================================================================
   app.scss — Único entrypoint de estilos (TemplateAngular20)
   -----------------------------------------------------------------------------
   - Carga tokens (colores + tipografía)
   - Define layout/base/bridge de tema
   - Ajustes suaves para DevExtreme y utilidades
   - Sin !important
   ============================================================================= */

/* ===== IMPORTS ===== */
@use "./colors" as *; /* palettes + skins por [data-skin] */
@use "./typography" as *; /* tipografía base 13px + escala rem */
@use "./dx-overrides" as *; /* Estilos para Dev Extreme */

/* ===== CSS CUSTOM PROPERTIES ===== */
:root {
  /* Layout Shell */
  --navbar-h: 45px; /* altura navbar unificada */
  --bc-h: 36px; /* breadcrumbs */
  --hdr-h: 40px; /* page header */
  --footer-h: 32px; /* footer */
  --sidebar-w: 224px; /* sidebar width */
  --sidebar-w-collapsed: 72px;

  /* Offsets dinámicos (se activan con flags en body) */
  --off-nav: 0px;
  --off-bc: 0px;
  --off-hdr: 0px;

  /* Design tokens */
  --card-radius: 0.75rem;
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 10px rgba(0, 0, 0, 0.08);

  /* Sidebar colors */
  --sb-bg: #0f172a;
  --sb-color: #e2e8f0;

  /* Z-index scale */
  --z-1: 1;
  --z-10: 10;
  --z-50: 50;
  --z-100: 100;
  --z-1000: 1000;
  --z-sidebar: 1000;
  --z-header: 1010;
  --z-breadcrumbs: 1020;
  --z-navbar: 1030;
}

/* ===== RESET Y BASE ===== */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
}

img {
  max-width: 100%;
  height: auto;
}

/* ===== SISTEMA DE FLAGS PARA ELEMENTOS FIJOS ===== */
/* Los offsets se activan cuando el flag correspondiente está en <body> */
body.navbar-fixed {
  --off-nav: var(--navbar-h);
}

body.breadcrumbs-fixed {
  --off-bc: var(--bc-h);
}

body.page-header-fixed {
  --off-hdr: var(--hdr-h);
}

/* ===== LAYOUT PRINCIPAL (APP SHELL) ===== */
.app-shell {
  min-height: 100dvh;
  display: grid;
  grid-template-rows: var(--navbar-h) var(--bc-h) 1fr var(--footer-h);
}

/* Navbar */
.app-navbar,
.page-navbar {
  height: var(--navbar-h);
  box-shadow: var(--shadow-sm);
}

/* Breadcrumbs */
.app-breadcrumbs,
.page-breadcrumbs {
  height: var(--bc-h);
  display: flex;
  align-items: center;
}

/* Page Header */
.page-header {
  height: var(--hdr-h);
}

/* Content */
.app-content,
.page-content {
  padding: 1rem;
  /* Compensación dinámica por elementos fijos */
  padding-top: calc(var(--off-nav) + var(--off-bc) + var(--off-hdr));
  margin-left: var(--sidebar-w);
}

/* Footer */
.app-footer {
  height: var(--footer-h);
  display: flex;
  align-items: center;
}

/* ===== SIDEBAR ===== */
.app-sidebar,
.page-sidebar {
  width: var(--sidebar-w);
  background: var(--sb-bg);
  color: var(--sb-color);

  &.is-collapsed {
    width: var(--sidebar-w-collapsed);
  }

  &.hide ~ .page-content {
    margin-left: 0 !important;
  }
}

/* ===== ELEMENTOS FIJOS ===== */
/* Soporte para flags en <body> o clases directas en el elemento */

/* Navbar fija */
body.navbar-fixed .page-navbar,
.page-navbar.navbar-fixed {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: var(--z-navbar);
}

/* Breadcrumbs fijas */
body.breadcrumbs-fixed .page-breadcrumbs,
.page-breadcrumbs.breadcrumbs-fixed {
  position: fixed;
  top: var(--off-nav);
  left: 0;
  right: 0;
  z-index: var(--z-breadcrumbs);
}

/* Header fijo */
body.page-header-fixed .page-header,
.page-header.page-header-fixed {
  position: fixed;
  top: calc(var(--off-nav) + var(--off-bc));
  left: 0;
  right: 0;
  z-index: var(--z-header);
}

/* Sidebar fijo */
body.sidebar-fixed .page-sidebar,
.page-sidebar.sidebar-fixed {
  position: fixed;
  top: calc(var(--off-nav) + var(--off-bc) + var(--off-hdr));
  bottom: 0;
  left: 0;
  width: var(--sidebar-w);
  z-index: var(--z-sidebar);
}

/* ===== COMPONENTES UI ===== */
/* Cards */
.card {
  border-radius: var(--card-radius);
  box-shadow: var(--shadow-sm);
}

/* Modals */
.modal-content {
  border-radius: var(--card-radius);
  box-shadow: var(--shadow-md);
}

/* ===== BRIDGE BS3 → BS5 (LEGACY) ===== */
.btn-default {
  @supports (color: var(--bs-body-color)) {
    color: var(--bs-body-color);
    background-color: var(--bs-secondary-bg, #e9ecef);
    border-color: var(--bs-border-color, #dee2e6);
  }
}

.panel {
  border-radius: var(--card-radius);
  box-shadow: var(--shadow-sm);

  &-heading {
    font-weight: 600;
  }

  &-body {
    padding: 1rem;
  }
}

/* Tabs con color de skin */
.nav-tabs .nav-link.active {
  color: var(--bs-primary);
  border-color: var(--bs-primary);
}

/* ===== DEVEXTREME AJUSTES ===== */
.dx-widget {
  font-size: var(--font-size-md);
  line-height: var(--line-height-base);
}

.dx-datagrid {
  .dx-datagrid-headers {
    font-weight: 600;
  }
}

.dx-datagrid-rowsview .dx-row td[data-type="number"] {
  text-align: right;
}

/* ===== UTILIDADES ===== */
.text-muted-2 {
  opacity: 0.75;
}

/* Width utilities */
.w-xxs {
  width: 8rem;
}
.w-xs {
  width: 12rem;
}
.w-sm {
  width: 16rem;
}

/* Empty state */
.app-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  color: var(--bs-secondary-color, #6c757d);
}

/* ===== MEDIA QUERIES ===== */
@media print {
  .app-sidebar,
  .app-navbar,
  .app-breadcrumbs,
  .app-footer,
  .page-sidebar,
  .page-navbar,
  .page-breadcrumbs {
    display: none;
  }
}
